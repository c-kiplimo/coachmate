<div class="row">
  <div class="col-10">
      <h3></h3>
  </div>
  <div class="col-2">
      <app-user></app-user>
  </div>
</div>
<button (click)="giveFeedback(sessionId)">Give Feedback</button>

<br>
<h5 class="section-title text-center ">Session Details</h5>
<div class="row">
  <div class="col-2">
  </div>
  <div class="col-8">
<div class="container-fluid Client mb-5">
    <div class="container">
      <div class="card details-card">
        <div class="mt-5" class="d-flex justify-content-between flex-wrap"[@fadeIn]>
          <div>
            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#editsessionModal
            "
            >
              <i class="fas fa-edit"></i>
              Edit
            </button>
          </div>
          <div class="d-flex">
            <div class="dropdown">
              <a class="btn btn-success dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                data-bs-toggle="dropdown" aria-expanded="false">
                Actions</a>
                <ul class="dropdown-menu dropdown-menu-end">
                  <li>
                    <a
                      class="dropdown-item"
                      data-bs-toggle="modal"
                      data-bs-target="#editsessionModal"
                      >Confirm</a
                    >
            
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      data-bs-toggle="modal"
                      data-bs-target="#editsessionModal"
                      >conducted</a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      data-bs-toggle="modal"
                      data-bs-target="#cancelsessionModal"
                      >Cancel</a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      data-bs-toggle="modal"
                      data-bs-target="#editsessionModal"
                      >Reschedule</a
                    >
                  </li>
                </ul>
            </div>
           
          </div>
        </div>
        <div class="session-details" [@fadeIn] >
          <div class="d-flex justify-content-between main-detail">
            <span class="title">Session for:</span>
            <span class="value">{{ sessions.name }}</span>
          </div>
          <div class="client-details" >
            <div class="d-flex justify-content-between">
              <span class="title">Session Date</span>
              <span class="value">{{ sessions.sessionDate }}</span>
            </div>
            <div class="d-flex justify-content-between">
              <span class="title">Client name</span>
              <span class="value">{{ sessions.client.fullName }}</span>
            </div>
            <div class="d-flex justify-content-between">
              <span class="title">Session type</span>
              <span class="value">{{ sessions.sessionType}}</span>
            </div>
            <div class="d-flex justify-content-between">
              <span class="title">Start Time</span>
              <span class="value">{{ sessions.sessionStartTime}}</span>
            </div>
            <div class="d-flex justify-content-between">
              <span class="title">End Time</span>
              <span class="value">{{ sessions.sessionEndTime }}</span>
            </div>
            <div class="d-flex justify-content-between">
              <span class="title">Status</span>
              <span class="value">{{ sessions.sessionStatus }}</span>
            </div>
  
            <div class="d-flex justify-content-between">
              <span class="title">Amount paid</span>
              <span class="value">{{ sessions.amountPaid }}</span>
            </div>
        
            <div class="d-flex justify-content-between">
              <span class="title">Session Venue</span>
              <span class="value">{{sessions.sessionVenue}}</span>
            </div>
          </div>
        </div>
      </div>
      </div>
    </div>
    </div>
  </div>
  <div class="card  details-card">
    <div class="tabs-section">
      <button

        class="btn btn-tabs"
        (click)="toggleTab('feedback')"
        [ngClass]="{ 'active-tab': currentTab === 'feedback' }"
      >
        Feedback
      </button>

      <button
        class="btn btn-outline-success"
        (click)="toggleTab('notifications')"
        [ngClass]="{ 'active-tab': currentTab === 'notifications' }"
      >
        Notifications
      </button>
      <button
          class="btn btn-outline-success"
          (click)="toggleTab('attachments')"
          [ngClass]="{ 'active-tab': currentTab === 'attachments' }"
        >
          Attachments
        </button>
    </div>

      <div *ngIf="currentTab === 'feedback'" [@fadeIn]>
        <div class="row list-container container  " >
      <table class="table" >

        <thead>
          <th colspan="1">Understanding</th>
          <th colspan="1">Emotional Intelligence</th>
          <th colspan="1">Listening Skills</th>
          <th colspan="1">Clarification</th>
          <th colspan="1">Availability</th>
          <th colspan="1">Total Score</th>
        </thead>
        <tbody>
          <tr>
            
            <td>{{feedback.understandingScore}}</td>
            <td>{{feedback.emotionalIntelligenceScore}}</td>
            <td>{{feedback.listeningSkillsScore}}</td>
            <td>{{feedback.clarificationScore }}</td>
            <td>{{feedback.availabilityScore }}</td>
            <td>{{feedback.overallScore}}</td>
          </tr>
        </tbody>
      </table>
      <h6>Client comments</h6>
      <p>{{feedback.comments}}</p>
    </div>
      </div>
    <div
      class="d-none d-lg-block"
      *ngIf="currentTab === 'notifications'"
      [@fadeIn]
    >
      <table class="table">
        <thead>
          <th coslpan="1">Notification Reason</th>
          <th coslpan="1">Notification Date</th>
          <th coslpan="1">Notification Mode</th>
        </thead>
        <tbody *ngIf="notifications.length">
          <tr *ngFor="let notification of notifications">
            <td>{{ notification.subject }}</td>
            <td>{{ notification.sentAt | date : "MMM d, y " }}</td>
            <td>{{ notification.notificationMode }}</td>
            <td>
              <button
                class="btn btn-view"
                data-bs-toggle="modal"
                data-bs-target="#notificationModal"
                (click)="viewNotification(notification)"
              >
                view
              </button>
            </td>
          </tr>
        </tbody>
      </table>

      <p class="text-muted text-center" *ngIf="!notifications?.length">
        no notifications found
      </p>
    </div>

    <div class="show-ms" *ngIf="currentTab === 'notifications'" [@fadeIn]>
      <p class="text-muted mt-5" *ngIf="!notifications?.length">
        No notifications found.
      </p>
      <div *ngIf="notifications?.length">
        <div
          data-bs-toggle="modal"
          data-bs-target="#notificationModal"
          (click)="viewNotification(notification)"
          *ngFor="let notification of notifications"
          class="listing-item"
        >
          <div class="d-flex justify-content-between mb-1">
            <div>
              <p class="mb-1">{{ notification.subject }}</p>
              <p class="mb-1">{{ notification.notificationMode }}</p>
            </div>
            <span
              >{{ notification.sentAt | date : "MMM d, y " }}
              <fa-icon [icon]="rightIcon"> </fa-icon>
            </span>
          </div>
        </div>
      </div>
    </div>
    <div class="d-none d-md-block">
        <table class="table" *ngIf="currentTab === 'attachments'" [@fadeIn]>
          <thead>
            <th coslpan="1">Attachment No</th>
            <th coslpan="1">Attachment date</th>
            <th coslpan="1">Details</th>
          </thead>
          <tbody>
            <tr *ngFor="let attachment of attachments">
              <td>{{ attachment.refNo }}</td>
              <td>{{ attachment.amount }}</td>
              <td>{{ attachment.date }}</td>
              <td>
                <button
                  class="btn btn-view-session"
                  data-bs-toggle="modal"
                  data-bs-target="#payementModal"
                >
                  View
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="show-ms" *ngIf="currentTab === 'attachments'" [@fadeIn]>
        <div *ngFor="let attachment of attachments" class="listing-item">
          <div class="d-flex justify-content-between mb-3">
            <h4>{{ attachment.session.name }}</h4>
            <span>{{ attachment.amount }}</span>
          </div>
          <span>{{ attachment.narration }}</span>
          <h6>{{ attachment.paidAt | date: "MMM d, y " }}</h6>
        </div>
      </div>
  </div>
<!-- Notification details modal -->
<div
  class="modal fade"
  id="notificationModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">
          Notification Details
        </h1>

        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body" *ngIf="notification">
        <div class="d-flex justify-content-between">
          <p>Notification Subject:</p>
          <span>{{ notification.subject }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>Reason</p>
          <span>{{ notification.sendReason }}</span>
        </div>

        <div class="d-flex justify-content-between">
          <p>Source Address</p>
          <span>{{ notification.srcAddress }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>Sent at:</p>
          <span>{{ notification.sentAt | date : "MMM d, y " }}</span>
        </div>
        <div class="d-flex-column">
          <p>Content:</p>
          <span>{{ notification.content }}</span>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-cancel" data-bs-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<!-- edit session modal -->
<div
  class="modal fade"
  id="editsessionModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Edit session</h1>

        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="editedsessionForm" >
          <div class="row p-2">
            <div class=" mb-3 col-md-6 ">
              <label for="name">Session Name *</label>
              <input
              formControlName="name"
              value="{{currentSessionName?.name}}"
                name="name"
                type="text"
                class="form-control"
                id="name"
                required
              />
            </div>
          <div class="row p-2">
            <div class=" mb-3 col-md-6 ">
              <label for="inputlastname">Session Details</label>
              <input 
              formControlName="details"
              value="{{currentdetails?.provider}}"
              type="text" 
              class="form-control" 
              id="inputEmail4" 
              placeholder="Enter Session Description" 
              name="details" 
              required >
            
            </div>
            <div class="mb-3 col-md-6">
              <label for="inputEmail4">Session Date</label>
              <input
              formControlName="sessionDate"
              value="{{currentSessionDate?.sessionDate}}" 
              type="date" 
              variant="success" 
              class="form-control" 
              id="inputEmail4" 
              placeholder="Date" 
              name="session_date" 
              >   
            </div>
          </div>
          <div class="row p-2">
              <div class="mb-3 col-md-6">
                <label for="inputEmail4">From</label>
                <input
                formControlName="sessionStartTime"
                value="{{currentsessionStartTime?.sessionStartTime}}" 
                type="time" 
                class="form-control" 
                id="inputEmail4" 
                placeholder="Time" 
                name="session_time_from" 
               >
                </div>
            <div class="mb-3 col-md-6">
              <label for="inputEmail4">To</label>
              <input 
              formControlName="sessionEndTime"
              value="{{currentsessionEndTime?.provider}}"
              type="time" 
              class="form-control" 
              id="inputEmail4" 
              placeholder="Time" 
              name="session_time_to" 
              >
            </div>
          </div>
          <div class="row p-2">
            <div class=" mb-3 col-md-6 ">
                <label class="form-group-text" for="clientType">Session Venue</label>
            <select 
            formControlName="sessionVenue"
            value="{{currentsessionVenue?.sessionVenue}}"
            class="form-select" 
                id="inputGroupSelect01" 
                name="session_venue" 
               >
                <option value="VIRTUAL">VIRTUAL</option>
                <option value="PHYSICAL">PHYSICAL</option>
              </select>
                </div>
                <div class="mb-3 col-md-6">
                  <label for="inputEmail4">Session Goals</label>
                  <input 
                  formControlName="goals"
                  value="{{currentgoals?.goals}}"
                  type="email" class="form-control" 
                  id="inputEmail4" placeholder="Goals" 
                  name="goals" >
                </div>
         <div class="d-flex input-group mb-3 mt-3">
          <label for="notification">Notify the client</label>
          <div class="d-flex-column justify-content-between ms-3">
            <label class="">
              <input
                type="checkbox"
                checked
                name="notification"
                [(ngModel)]="showHideMessage"
                formControlName="sendNotification"
              />
              <span class=""></span>
            </label>
          </div>
        </div> 
         <div *ngIf="!showHideMessage" [@fadeIn]>
        <p>The Client will not be notified</p>
      </div> 
        <div class="col mb-3" *ngIf="showHideMessage" [@fadeIn]>
        <div class="">
          <label for="message">Message to be sent</label>
          <p class="lead">
            "Dear {{ client?.firstName | titlecase }}. Your
            {{ sessionType }} session of amount {{ sessionDuration }} has been
            recorded. I am working to promptly have your session delivered by
            {{ sessionDate | date }}. Thank you. "
          </p>
        </div>
      </div> 
      </div>
      <div class="modal-footer d-flex justify-content-between">
        <button type="button" class="btn btn-cancel" data-bs-dismiss="modal">
          Cancel
        </button>
        <button
          type="button"
          class="btn btn-submit"
          data-bs-dismiss="modal"
          (click)="editedSession()"
        >
          Update session
        </button>
      </div>
    </div>
<!-- Confirm session modal -->
<div
  class="modal fade bd-example-modal-lg"
  id="confirmsessionModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Confirm session</h1>

        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body" *ngIf="session">
        <div class="d-flex justify-content-between">
          <p>Client Name</p>
          <span>{{
            sessions.client.fullName 
              | titlecase
          }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>Product</p>
          <span>{{ session.details }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>Session Type</p>
          <span>{{ session.sessionType }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>session Amount</p>
          <span>{{ session.sessionDuration }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>session Amount Paid</p>
          <span>{{ session.amountPaid }}</span>
        </div>

        <form [formGroup]="confirmSessionForm">
          <div class="mb-3">
            <label for="exampleInputEmail1">narration</label>
            <textarea
              formControlName="narration"
              name="narration"
              class="form-control"
              id="narration"
              aria-describedby="narration"
              placeholder="narration for confirming the session"
            >
            </textarea>
          </div>
          <div class="d-flex justify-content-between mb-3">
            <label for="exampleInputEmail1">notify the client</label>
            <div class="toggle">
              <label class="switch">
                <input type="checkbox" name="cancelsession" checked />
                <span class="slider round"></span>
              </label>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-cancel" data-bs-dismiss="modal">
          Close
        </button>
        <button
          type="button"
          class="btn btn-submit"
          data-bs-dismiss="modal"
          (click)="confirmSession()"
        >
          Submit
        </button>
      </div>
    </div>
  </div>
</div>

<!-- conducted session modal -->
<div
  class="modal fade bd-example-modal-lg"
  id="conductedsessionModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" >
          Conducted session
        </h1>

        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body" *ngIf="session">
        <div class="d-flex justify-content-between">
          <p>Client Name</p>
          <span>{{
            sessions.client.fullName 
              | titlecase
          }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>Product</p>
          <span>{{ session.details }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>Session Type</p>
          <span>{{ session.sessionType }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>session Amount</p>
          <span>{{ session.sessionDuration }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>session Amount Paid</p>
          <span>{{ session.amountPaid }}</span>
        </div>
        <form [formGroup]="conductedSessionForm">
          <div class="mb-3">
            <label for="exampleInputEmail1">Conducted  On</label>
            <input
              formControlName="sessionDate"
              [(ngModel)]="sessionDate"
              name="deliveredOn"
              type="date"
              class="form-control"
              id="deliveredOn"
              aria-describedby="emailHelp"
              placeholder="On Date"
            />
          </div>
          <div class="mb-3">
            <label for="exampleInputEmail1">Time</label>
            <input
              formControlName="sessionStartTime"
              [(ngModel)]="sessionStartTime"
              name="deliveredtime"
              type="time"
              class="form-control"
              id="deliveredtime"
              aria-describedby="emailHelp"
              placeholder="Delivery time"
            />
          </div>
          <div class="mb-3">
            <label for="exampleInputEmail1">goals</label>
            <textarea
              formControlName="goals"
              name="narration"
              class="form-control"
              id="narration"
              aria-describedby="narration"
              placeholder="narration for delivering the session"
            >
            </textarea>
          </div>
          <div class="d-flex justify-content-between mb-3">
            <label for="exampleInputEmail1">Notify the client</label>
            <div class="toggle">
              <label class="switch">
                <input type="checkbox" name="cancelsession" checked />
                <span class="slider round"></span>
              </label>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-cancel" data-bs-dismiss="modal">
          Close
        </button>
        <button
          type="button"
          class="btn btn-submit"
          data-bs-dismiss="modal"
          (click)="ConductedSession()"
        >
          Submit
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Cancel session modal -->
<div
  class="modal fade bd-example-modal-lg"
  id="cancelsessionModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5">Cancel session</h1>

        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body" *ngIf="session">
        <div class="d-flex justify-content-between">
          <p>Client Name</p>
          <span>{{
            sessions.client.fullName 
              | titlecase
          }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>Balance</p>
          <span>{{ session.sessionBalance }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>Session Type</p>
          <span>{{ session.sessionType }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>session Duration</p>
          <span>{{ session.sessionDuration }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>session Amount Paid</p>
          <span>{{ session.amountPaid }}</span>
        </div>
        <form [formGroup]="cancelSessionForm">
          <div class="mb-3">
            <label for="exampleInputEmail1">narration</label>
            <textarea
              formControlName="narration"
              name="narration"
              class="form-control"
              id="narration"
              aria-describedby="narration"
              placeholder="narration for cancelling the session"
            >
            </textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-cancel" data-bs-dismiss="modal">
          Close
        </button>
        <button
          type="button"
          class="btn btn-submit"
          data-bs-dismiss="modal"
          (click)="cancelSession()"
        >
          Submit
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Delete session modal -->
<div
  class="modal fade bd-example-modal-lg"
  id="deletesessionModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5">Delete session</h1>

        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body" *ngIf="session">
        <div class="d-flex justify-content-between">
          <p>Client Name</p>
          <span>{{
            sessions.client.fullName 
              | titlecase
          }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>Balance</p>
          <span>{{ session.sessionBalance }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>Session Type</p>
          <span>{{ session.sessionType }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>session Amount</p>
          <span>{{ session.sessionDuration }}</span>
        </div>
        <div class="d-flex justify-content-between">
          <p>session Amount Paid</p>
          <span>{{ session.amountPaid }}</span>
        </div>
        <form [formGroup]="deleteSessionForm">
          <div class="mb-3">
            <label for="exampleInputEmail1">narration</label>
            <textarea
              formControlName="narration"
              name="narration"
              class="form-control"
              id="narration"
              aria-describedby="narration"
              placeholder="narration for deleting the session"
            >
            </textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-cancel" data-bs-dismiss="modal">
          Close
        </button>
        <button
          type="button"
          class="btn btn-submit"
          data-bs-dismiss="modal"
          (click)="deleteSession()"
        >
          Submit
        </button>
      </div>
    </div>
  </div>
</div>