<div class="row">
  <div class="d-flex justify-content-between mt-2">
    <div class="col  mt-4" style="margin-left: 5px;">
      <h3 class="fw-semi-bold fs-5 f-weight ">Dashboard</h3>
    </div>
    <div>
      <button *ngIf="this.userRole != 'COACH' && this.userRole != 'CLIENT'" class="btn btn-outline-success m-1"
        routerLink="/addCoach"><i class="fa fa-plus"></i> Add Coach</button>
      <button *ngIf="this.userRole != 'CLIENT'" class="btn btn-outline-success m-1" routerLink="/addclient"><i
          class="fa fa-plus"></i> Add Client</button>
      <button *ngIf="this.userRole != 'CLIENT'" class="btn btn-outline-success m-1" routerLink="/add-contract"><i
          class="fa fa-plus"></i> Add
        Contract</button>

      <button *ngIf="this.userRole != 'CLIENT'" class="btn btn-outline-success m-1" routerLink="/addSession"><i
          class="fa fa-plus"></i> Add Session</button>
    </div>
  </div>
</div>

<div class="row dashboard-banner d-flex justify-content-between align-items-center p-3">
  <div class="col-10 text-center p-3 mb-10">
    <h2 class="fw-bold" *ngIf="this.userRole == 'ORGANIZATION'">
      Hello {{orgName | lowercase }},
      <span class="fw-light">
        Welcome back!
      </span>
    </h2>
    <h2 class="fw-bold" *ngIf="this.userRole == 'COACH'">
      Hello {{user.firstName| lowercase }},
      <span class="fw-light">
        Welcome back!
      </span>
    </h2>
    <h2 class="fw-bold" *ngIf="this.userRole == 'CLIENT'">
      Hello {{user.fullName| lowercase }},
      <span class="fw-light">
        Welcome back!
      </span>
    </h2>
  </div>
</div>

<div class="row">
  <div class="col-10">
    <p class="p-3 desc ">Hello {{user.firstName| lowercase }}, Here's how things currently look like...</p>
  </div>
</div>


<div class="row" *ngIf="this.userRole != 'ORGANIZATION'">
  <div class="col-md-12">
    <div class="card">
      <div class="card-body">

        <div class="row justify-content-center">
          <div class="col-md-7 col-sm-12">
            <!--Tabs-->
            <div class="d-none d-lg-block">
              <ul *ngIf="userRole !== 'CLIENT'" class="nav nav-tabs md-tabs nav-justified" id="myTabJust"
                role="tablist">
                <li class="nav-item" (click)="toggleTab('sessions')">
                  <a class="nav-link" [class.active]="currentTab === 'sessions'" id="home-tab-just" data-toggle="tab"
                    role="tab" aria-controls="home-just" aria-selected="true"><i class="fa-solid fa-chalkboard-user"
                      style="color: green"></i> Upcoming Sessions</a>
                </li>
                <li class="nav-item" (click)="toggleTab('contracts')">
                  <a class="nav-link" [class.active]="currentTab === 'contracts'" id="contact-tab-just"
                    data-toggle="tab" role="tab" aria-controls="contact-just" aria-selected="false"><i
                      class="fa-solid fa-file-contract" style="color: green"></i> Recent Contracts</a>
                </li>
              </ul>
            </div>

            <div class="show-sm">
              <ul class="nav nav-tabs md-tabs nav-justified" id="myTabJust" role="tablist">
                <li class="nav-item" (click)="toggleTab('sessions')">
                  <a class="nav-link" [class.active]="currentTab === 'sessions'" id="home-tab-just" data-toggle="tab"
                    role="tab" aria-controls="home-just" aria-selected="true"><i class="fa-solid fa-chalkboard-user"
                      style="color: green"></i></a>
                </li>
                <li class="nav-item" (click)="toggleTab('contracts')">
                  <a class="nav-link" [class.active]="currentTab === 'contracts'" id="contact-tab-just"
                    data-toggle="tab" role="tab" aria-controls="contact-just" aria-selected="false"><i
                      class="fa-solid fa-file-contract" style="color: green"></i></a>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <br>

        <div *ngIf="currentTab === 'sessions'" [@fadeIn]>
          <div class="d-none d-lg-block">

            <div class="d-flex justify-content-between">
              <div></div>
              <a [routerLink]="['/sessions']">
                <span class="seeAll float-end">View all <i class="fas fa-arrow-right"></i></span>
              </a>
            </div>

            <div class="row justify-content-center">
              <table class="table" *ngIf="sessions?.length">
                <thead>
                  <th>Name</th>
                  <th>Contract</th>
                  <th scope="col" *ngIf="this.userRole != 'CLIENT'">Client</th>
                  <th>Venue</th>
                  <th>Date</th>
                  <th>Start Time</th>
                  <th>End Time</th>

                  <th>Status</th>
                  <th>Actions</th>
                </thead>
                <tbody class="list-container">
                  <tr *ngFor="let session of sessions">
                    <td>{{ session?.name }}</td>
                    <td>{{ session?.contractCoachingTopic.slice(0, 20) }}...</td>
                    <td *ngIf="this.userRole != 'CLIENT'">{{ session?.clientFullName }}</td>
                    <td>{{ session?.sessionVenue | titlecase }}</td>

                    <td *ngIf="session.sessionSchedulesSessionDate">{{ session?.sessionSchedulesSessionDate }}</td>
                    <td *ngIf="!session.sessionSchedulesSessionDate">{{ session?.sessionDate }}</td>

                    <td>{{ session?.sessionSchedulesStartTime  }}</td>
                    <td>{{ session?.sessionSchedulesEndTime }}</td>
                    <td>
                      <span class="badge" [ngClass]="{
                    'badge-success': session?.sessionStatus === 'CONFIRMED',
                    'badge-danger': session?.sessionStatus === 'CANCELLED',
                    'badge-primary': session?.sessionStatus === 'NEW' || session?.sessionStatus === 'CONDUCTED'
                  }">{{ session?.sessionStatus }}</span>
                    </td>
                    <td class="view">
                      <a [routerLink]="['/sessionView/', session?.id]"><i class="fas fa-external-link-alt"></i></a>
                    </td>

                  </tr>
                </tbody>
              </table>
              <div class="donut-wrapper" *ngIf="loading" [@fadeIn]>
                <div class="donut multi"></div>
              </div>
              <p class="text-muted mt-5" *ngIf="!loading && !sessions?.length">
                No Sessions Yet.
              </p>
            </div>
          </div>

          <div class="show-sm">
            <div class="card">
              <div class="card-body">
                <div class="d-flex justify-content-between mt-2 mb-2">
                  <h3></h3>
                  <div>
                    <button type="button" routerLink="/addSession" class="btn btn-success">
                      <i class="fa fa-plus"></i>
                    </button>
                  </div>
                </div>

                <div class="pt-3 pb-2 listing-item"
                  *ngFor="let session of sessions  | paginate: { itemsPerPage: pageSize, currentPage: page, totalItems: totalElements }"
                  [routerLink]="['/sessionView', session.id]">


                  <div class="d-flex justify-content-between">
                    <h4 class="farmer" [routerLink]="['/sessionView', session.id]">
                      {{ session?.name | titlecase }}
                    </h4>

                    <span class="no-word-break">{{ session?.sessionVenue | titlecase }}
                      <a [routerLink]="['/sessionView', session.id]"><i class="fa fa-angle-right"></i></a>
                    </span>
                  </div>

                  <div class="d-flex justify-content-between mb-2">
                    <span class="customer-name" class="mb-0">
                      {{ session?.clientFullName | titlecase }}</span>
                  </div>
                  <div class="d-flex justify-content-between mb-2">
                    <span class="customer-name" class="mb-0">
                      {{ session?.sessionSchedulesSessionDate }}
                    </span>
                  </div>
                  <div class="d-flex justify-content-between mb-2">
                    <span class="customer-name" class="mb-0">
                      {{ session?.sessionSchedulesStartTime + ' - ' + session?.sessionSchedulesEndTime }}
                    </span>
                  </div>

                  <div class="d-flex justify-content-between mb-1">
                    <span class="badge" [ngClass]="{
                      'badge-success': session.sessionStatus === 'CONFIRMED',
                      'badge-danger': session.sessionStatus === 'CANCELLED',
                      'badge-primary': session.sessionStatus === 'NEW' || session.sessionStatus === 'CONDUCTED'
                    }">{{ session.sessionStatus }}</span>
                  </div>
                </div>

                <div class="donut-wrapper" *ngIf="loading">
                  <div class="donut multi"></div>
                </div>
                <div *ngIf="!loading && sessions?.length === 0">
                  <h2 class="text-muted mt-5">No Sessions Found.</h2>
                </div>

              </div>
            </div>
          </div>
        </div>

        <div *ngIf="currentTab === 'contracts'" [@fadeIn]>
          <div class="d-none d-lg-block">
            <div class="d-flex justify-content-between">
              <div></div>
              <a [routerLink]="['/contracts']">
                <span class="seeAll float-end">View all <i class="fas fa-arrow-right"></i></span>
              </a>
            </div>
            <div class="row justify-content-center">
              <table class="table" *ngIf="contracts?.length">
                <thead>
                  <th colspan="1">Name</th>
                  <th colspan="1">Client</th>
                  <th colspan="1">Category</th>
                  <th colspan="1">Start Date</th>
                  <th colspan="1">End Date</th>
                  <th colspan="1">No of Sessions</th>
                  <th colspan="1">Status</th>
                  <th colspan="1">Actions</th>
                </thead>
                <tbody>
                  <tr *ngFor="let contract of contracts">
                    <td>{{ contract?.coachingTopic.slice(0, 20) }}</td>
                    <td>{{ contract?.clientFullName }}</td>
                    <td>{{ contract?.coachingCategory }}</td>
                    <td>{{ contract?.startDate | date : "MMM d, y" }}</td>
                    <td>{{ contract?.endDate | date : "MMM d, y" }}</td>
                    <td>{{ contract?.noOfSessions }}</td>
                    <td>
                      <span class="badge" [ngClass]="{
                          'badge-success': contract?.contractStatus === 'SIGNED' || contract?.contractStatus === 'FINISHED',
                          'badge-danger': contract?.contractStatus === 'ONGOING',
                          'badge-primary': contract?.contractStatus === 'NEW'
                        }">{{ contract?.contractStatus }}</span>
                    </td>
                    <td class="view">
                      <a [routerLink]="['/contractDetail/', contract.id]"><i class="fas fa-external-link-alt"></i></a>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div class="donut-wrapper" *ngIf="loading" [@fadeIn]>
                <div class="donut multi"></div>

              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>
 
<div class="row" *ngIf="this.userRole == 'ORGANIZATION'">
  <div class="col-md-12">
    <div class="card upcomingSessions">
      <div class="card-body d-flex justify-content-between">
        <h3 class="card-title fw-bold">Coaches</h3>
        <a [routerLink]="['/coaches']">
          <span class="seeAll float-end">View all <i class="fas fa-arrow-right"></i></span>
        </a>
      </div>
      <div class="card-body">
        <!-- upcomingsessionsTable list-container container -->
        <table class="table" *ngIf="coaches?.length">
          <thead>
            <th colspan="1">Name</th>
            <th colspan="1">Email</th>
            <th colspan="1">Phone</th>
            <th colspan="1">Created On</th>
            <th colspan="1">Status</th>
            <th colspan="1">Actions</th>
          </thead>
          <tbody class="list-container">
            <tr *ngFor="let coach of coaches">
              <td>{{ coach.fullName }}</td>
              <td>{{ coach.email}}</td>
              <td>{{ coach.msisdn }}</td>
              <td>{{ coach.createdAt | date: "MMM d y"}}</td>

              <td>
                <span class="badge" [ngClass]="{
                    'badge-success': coach?.coachStatus === 'ACTIVE' || coach?.coachStatus === 'NEW',
                    'badge-danger': coach?.coachStatus === 'SUSPENDED',
                    'badge-primary': coach?.coachStatus === 'CLOSED'
                  }">
                  {{ coach.coachStatus }}</span>

              <td class="view">
                <a [routerLink]="['/coachView', coach.id]"><i class="fas fa-external-link-alt"></i></a>
                <!-- <button type="button" class="btn btn-sm btn-success" routerLink="/editclient/{{coach.id}}">View</button> -->
              </td>

            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="row row-height" *ngIf="this.userRole == 'COACH'">
  <!-- <div class="col-3 card text-center top-cards">
          <div class="card-body">
            <h6 class="card-title">Upcoming Sessions</h6>
            <h3 class="card-text fw-bold">{{numberOfSessions}}</h3>
            
          </div>
      </div> -->
  <!-- <div class="col-3 card text-center top-cards">
    <div class="card-body">
      <h6 class="card-title">Coaching Hours</h6>
      <h3 class="card-text fw-bold">{{numberOfHours}} hrs {{numberOfMinutes}} mins</h3>

    </div>
  </div> -->
  <!-- <div class="col-3 card text-center top-cards" >
      <div class="card-body">
        <h6 class="card-title">Coach Education</h6>
        <h3 class="card-text fw-bold">{{ numberOfHours }} hrs</h3>
        <button type="button" routerLink="/AddTraining" class="btn addbtn"><i class="fa fa-plus"></i> Add Training</button>
        
      </div>
  </div> -->
  <!-- <div class="col-3 card text-center top-cards">
    <div class="card-body">
      <h6 class="card-title">Sessions Created</h6>
            <h3 class="card-text fw-bold">{{numberOfSessions}}</h3>
      <h6 class="card-title">Sessions Success Rate</h6>
      <h3 class="card-text fw-bold">{{success_rate_percent}}%</h3>
    </div>
  </div> -->
  <div class="col-3 card text-center top-cards">
    <div class="card-body">
      <h6 class="card-title fw-semi-bold f-weight fs-6">Clients</h6>
      <h3 class="card-text fw-bold">{{numberOfClients}}</h3>
    </div>
  </div>
  <div class="col-3 card text-center top-cards">
    <div class="card-body">
      <h6 class="card-title fw-semi-bold f-weight fs-6">Contracts</h6>
      <h3 class="card-text fw-bold">{{numberOfContracts}}</h3>
    </div>
  </div>
</div>

<!--ORGANIZATION-->
<div class="row row-height" *ngIf="this.userRole == 'ORGANIZATION'">

  <div class="col-3 card text-center top-cards">
    <div class="card-body">
      <h6 class="card-title fw-semi-bold f-weight fs-6">Number of Coaches</h6>
      <h3 class="card-text fw-bold">{{coaches.length}}</h3>
    </div>
  </div>
  <div class="col-3 card text-center top-cards">
    <div class="card-body">
      <h6 class="card-title fw-semi-bold f-weight fs-6">Number of Clients</h6>
      <h3 class="card-text fw-bold">{{clients.length}}</h3>
    </div>
  </div>
  <div class="col-3 card text-center top-cards">
    <div class="card-body">
      <h6 class="card-title fw-semi-bold f-weight fs-6">Number of Contracts</h6>
      <h3 class="card-text fw-bold">{{numberOfContracts}}</h3>
    </div>
  </div>
</div>
